# Документ требований

## Введение

Данная спецификация описывает архитектурный рефакторинг и завершение модернизации UI для Universo Platformo React. Цель - исправить архитектурные проблемы, возникшие при первоначальной реализации спецификации `universo-ui-modernization`, и правильно реализовать компоненты карточек и списков на основе MUI Dashboard шаблона, который в настоящее время работает в Униборде.

## Требования

### Требование 1

**Пользовательская история:** Как разработчик, я хочу реструктурировать компоненты MUI шаблона для соответствия правильным архитектурным паттернам, чтобы кодовая база была поддерживаемой и масштабируемой.

#### Критерии приемки

1. КОГДА реорганизуются компоненты шаблона ТОГДА папка компонентов dashboard ДОЛЖНА быть перемещена из `packages/universo-template-mui/base/src/views/dashboard/components` в `packages/universo-template-mui/base/src/components/dashboard`
2. КОГДА перемещаются компоненты ТОГДА все ссылки в `Dashboard.tsx` и `MainLayoutMUI.tsx` ДОЛЖНЫ быть соответственно обновлены
3. КОГДА реструктурируются файлы темы ТОГДА папка theme ДОЛЖНА быть перемещена из `packages/universo-template-mui/base/src/views/dashboard/theme` в `packages/universo-template-mui/base/src/theme`
4. КОГДА организуются общие компоненты ТОГДА папка internals ДОЛЖНА быть правильно перемещена и организована
5. КОГДА перемещаются компоненты auth ТОГДА папка `packages/universo-template-mui/base/src/views/auth` ДОЛЖНА быть перенесена в соответствующее место
6. КОГДА организуется папка shared ТОГДА `packages/universo-template-mui/base/src/views/shared` ДОЛЖНА быть правильно размещена для общих файлов шаблонов

### Требование 2

**Пользовательская история:** Как разработчик, я хочу создать переиспользуемые компоненты карточек на основе работающего dashboard шаблона, чтобы списки сущностей (Уники, Метавселенные, Кластеры) отображались единообразно во всем приложении.

#### Критерии приемки

1. КОГДА создаются компоненты карточек ТОГДА они ДОЛЖНЫ быть основаны на работающих карточках из `Dashboard.tsx` (конкретно `StatCard.tsx` и связанных компонентах)
2. КОГДА реализуются карточки ТОГДА они ДОЛЖНЫ следовать отзывчивому поведению, показанному в Униборде (4 карточки в ряду, затем 2 карточки в ряду на меньших экранах)
3. КОГДА отображаются данные сущности ТОГДА карточки ДОЛЖНЫ показывать название и описание сущности вместо демо-данных графиков
4. КОГДА создается карточка "больше информации" ТОГДА она ДОЛЖНА отображать текст и кнопку о том, что больше информации можно получить в документации, с кнопкой, ведущей на `https://teknokomo.gitbook.io/up`
5. КОГДА организуются компоненты карточек ТОГДА они ДОЛЖНЫ быть размещены в `packages/universo-template-mui/base/src/components/cards/`
6. КОГДА карточки уменьшаются ТОГДА они ДОЛЖНЫ сначала сужаться по ширине, а затем после определенной границы переноситься на следующую строку (2 в ряду)

### Требование 3

**Пользовательская история:** Как разработчик, я хочу создать переиспользуемые компоненты списков на основе dashboard шаблона, чтобы сущности могли отображаться как в формате карточек, так и в формате списков с единообразным стилем.

#### Критерии приемки

1. КОГДА создаются компоненты списков ТОГДА они ДОЛЖНЫ быть основаны на компонентах таблиц/списков из работающего dashboard шаблона
2. КОГДА реализуются списки ТОГДА они ДОЛЖНЫ включать функциональность пагинации, как показано в примере dashboard
3. КОГДА отображаются сущности ТОГДА формат списка ДОЛЖЕН быть доступен для всех типов сущностей (Уники, Метавселенные, Кластеры, Учетные данные, Переменные)
4. КОГДА реализуется пагинация ТОГДА она ДОЛЖНА работать как для режима отображения карточек, так и для режима списков
5. КОГДА организуются компоненты списков ТОГДА они ДОЛЖНЫ быть размещены в соответствующих папках компонентов

### Требование 4

**Пользовательская история:** Как разработчик, я хочу создать правильный компонент панели инструментов, который соответствует новому дизайну UI, чтобы фильтрация, переключение видов и кнопки действий работали единообразно на всех страницах сущностей.

#### Критерии приемки

1. КОГДА создается панель инструментов ТОГДА она ДОЛЖНА следовать паттернам дизайна из нового MUI шаблона
2. КОГДА реализуется панель инструментов ТОГДА она ДОЛЖНА включать функциональность поиска/фильтрации
3. КОГДА добавляются элементы управления видом ТОГДА она ДОЛЖНА включать переключение между видами карточек и списков
4. КОГДА добавляются кнопки действий ТОГДА она ДОЛЖНА включать кнопку "Создать" и контекстно-зависимые кнопки (например, "Загрузить")
5. КОГДА стилизуется панель инструментов ТОГДА она ДОЛЖНА быть полностью отзывчивой и соответствовать мобильному макету нового шаблона

### Требование 5

**Пользовательская история:** Как разработчик, я хочу удалить устаревшие и конфликтующие UI компоненты, чтобы кодовая база была чистой и не было конфликтов стилей.

#### Критерии приемки

1. КОГДА очищаются компоненты ТОГДА вся папка `packages/universo-template-mui/base/src/components/universal` ДОЛЖНА быть удалена
2. КОГДА удаляются тестовые компоненты ТОГДА `packages/universo-template-mui/base/src/components/EntityCard.tsx` ДОЛЖЕН быть удален
3. КОГДА очищаются стили ТОГДА любые конфликтующие глобальные стили из старого UI ДОЛЖНЫ быть отключены или удалены
4. КОГДА удаляются компоненты ТОГДА все ссылки на удаленные компоненты ДОЛЖНЫ быть обновлены или удалены

### Требование 6

**Пользовательская история:** Как разработчик, я хочу исправить проблемы интеграции маршрутизации, чтобы новые UI компоненты были правильно подключены к основному приложению без создания ненужного промежуточного кода.

#### Критерии приемки

1. КОГДА интегрируется с основными маршрутами ТОГДА подключение ДОЛЖНО быть сделано напрямую в `packages/flowise-core-frontend/base/src/App.jsx` или правильно в `packages/flowise-core-frontend/base/src/routes/index.jsx`
2. КОГДА очищается маршрутизация ТОГДА весь временный/тестовый код маршрутизации ДОЛЖЕН быть удален
3. КОГДА реализуется маршрутизация ТОГДА `MainRoutesMUI.tsx` и `MainLayoutMUI.tsx` ДОЛЖНЫ быть правильно интегрированы
4. КОГДА исправляется интеграция ТОГДА подход ДОЛЖЕН быть простым и прямым, избегая чрезмерной абстракции

### Требование 7

**Пользовательская история:** Как разработчик, я хочу правильно реализовать подход тонкого слоя абстракции, чтобы `packages/universo-templates/` служил простым переключателем тем, а не сложной абстракцией.

#### Критерии приемки

1. КОГДА реализуется слой абстракции ТОГДА `packages/universo-templates/` ДОЛЖЕН быть тонким переключателем, который определяет активный UI пакет
2. КОГДА подключается к основному UI ТОГДА переключатель ДОЛЖЕН предоставлять ссылки на основной роутер и основной макет
3. КОГДА реализуется логика переключения ТОГДА она ДОЛЖНА быть простой и сосредоточенной на выборе темы/шаблона
4. КОГДА интегрируется ТОГДА основная реализация ДОЛЖНА быть сначала в `packages/universo-template-mui/`, с добавлением абстракции позже

### Требование 8

**Пользовательская история:** Как пользователь, я хочу видеть списки сущностей (Уники, Метавселенные, Кластеры) отображенными с тем же отзывчивым макетом карточек, как показано в Униборде, чтобы интерфейс был единообразным и удобным для пользователя.

#### Критерии приемки

1. КОГДА просматривается список Уников ТОГДА карточки ДОЛЖНЫ отображаться в той же отзывчивой сетке, что и в Униборде (4 карточки, затем 2 карточки на меньших экранах)
2. КОГДА изменяется размер карточек ТОГДА они ДОЛЖНЫ сначала сужаться по ширине, затем переноситься на новые строки в определенной точке перелома
3. КОГДА отображается информация о сущности ТОГДА карточки ДОЛЖНЫ показывать название сущности, описание и соответствующие метаданные
4. КОГДА реализуется отзывчивое поведение ТОГДА оно ДОЛЖНО точно соответствовать поведению, показанному в dashboard Униборда
5. КОГДА текущий список Уников отображается в сетке из 3 карточек ТОГДА он ДОЛЖЕН быть заменен на правильную логику из 4 карточек, как в Униборде
6. КОГДА карточки отображаются ТОГДА они НЕ ДОЛЖНЫ использовать логику, похожую на изначальный UI Flowise

### Требование 9

**Пользовательская история:** Как разработчик, я хочу копировать и адаптировать существующие работающие компоненты, а не переписывать их, чтобы гарантировать, что функциональность работает как ожидается.

#### Критерии приемки

1. КОГДА реализуется новая функциональность ТОГДА существующие работающие компоненты ДОЛЖНЫ быть сначала скопированы, затем осторожно модифицированы
2. КОГДА адаптируются компоненты ТОГДА демо-данные ДОЛЖНЫ быть постепенно удалены и заменены реальными данными
3. КОГДА вносятся изменения ТОГДА модификации ДОЛЖНЫ быть инкрементальными и тестироваться на каждом шаге
4. КОГДА копируются компоненты ТОГДА оригинальные работающие версии ДОЛЖНЫ быть сохранены до полного тестирования новых версий

### Требование 10

**Пользовательская история:** Как разработчик, я хочу исправить проблемы мобильного макета, чтобы новый UI корректно отображался на всех размерах экрана без проблем с макетом.

#### Критерии приемки

1. КОГДА отображается на мобильном устройстве ТОГДА верхние отступы/padding ДОЛЖНЫ быть сохранены (в настоящее время отсутствуют в Униборде)
2. КОГДА интегрируются старые компоненты ТОГДА они НЕ ДОЛЖНЫ вызывать провал контента под верхнюю панель
3. КОГДА стилизуются компоненты ТОГДА избыточные боковые отступы из старого UI ДОЛЖНЫ быть удалены
4. КОГДА реализуется отзывчивый дизайн ТОГДА он ДОЛЖЕН следовать паттернам, установленным в новом MUI шаблоне

### Требование 11

**Пользовательская история:** Как разработчик, я хочу обеспечить, чтобы все страницы сущностей использовали новые UI компоненты, чтобы пользовательский опыт был единообразным во всем приложении.

#### Критерии приемки

1. КОГДА реализуется новый UI ТОГДА он ДОЛЖЕН быть применен ко всем страницам, которые отображают сущности в карточках или списках
2. КОГДА обновляются страницы ТОГДА отображение шаблона Spaces+Canvases ДОЛЖНО остаться неизменным (будет обновлено в будущей фазе)
3. КОГДА развертываются изменения ТОГДА профиль пользователя, аутентификация и связанная функциональность ДОЛЖНЫ быть рассмотрены в последующей фазе
4. КОГДА реализуется ТОГДА фокус ДОЛЖЕН быть на страницах списков сущностей (Уники, Метавселенные, Кластеры, Инструменты, Учетные данные, Переменные и т.д.)

### Требование 12

**Пользовательская история:** Как разработчик, я хочу поддерживать обратную совместимость и минимизировать изменения в оригинальном коде Flowise, чтобы будущие обновления оставались управляемыми.

#### Критерии приемки

1. КОГДА вносятся изменения ТОГДА модификации оригинального кода Flowise ДОЛЖНЫ быть минимальными
2. КОГДА реализуется новая функциональность ТОГДА она ДОЛЖНА быть добавлена в отдельные пакеты в `packages/`
3. КОГДА модифицируется существующий код ТОГДА изменения ДОЛЖНЫ быть обратно совместимыми
4. КОГДА интегрируется ТОГДА новая система ДОЛЖНА сосуществовать с текущей системой до полного перехода

### Требование 13

**Пользовательская история:** Как разработчик, я хочу следовать пошаговому подходу с четкой последовательностью действий, чтобы гарантировать стабильность системы на каждом этапе.

#### Критерии приемки

1. КОГДА выполняется архитектурная реструктуризация ТОГДА она ДОЛЖНА быть выполнена в первую очередь (перемещение папок и обновление ссылок)
2. КОГДА создаются новые компоненты карточек ТОГДА они ДОЛЖНЫ быть созданы после архитектурной реструктуризации
3. КОГДА создаются компоненты списков ТОГДА они ДОЛЖНЫ быть созданы после компонентов карточек
4. КОГДА создается панель инструментов ТОГДА она ДОЛЖНА быть создана после компонентов карточек и списков
5. КОГДА внедряется новый UI ТОГДА он ДОЛЖЕН быть внедрен во всех местах отображения карточек и списков только после создания всех базовых компонентов
6. КОГДА проверяется работа ТОГДА каждый этап ДОЛЖЕН быть протестирован перед переходом к следующему

### Требование 14

**Пользовательская история:** Как разработчик, я хочу исправить конкретные проблемы текущей реализации, чтобы устранить архитектурные недостатки.

#### Критерии приемки

1. КОГДА исправляется проблема с `packages/flowise-core-frontend/base/src/routes/index.jsx` ТОГДА весь мусорный/лишний код ДОЛЖЕН быть удален и заменен простым подключением новой структуры
2. КОГДА исправляется интеграция ТОГДА подключение ДОЛЖНО быть сделано правильно в `packages/flowise-core-frontend/base/src/App.jsx` или нормально в `packages/flowise-core-frontend/base/src/routes/index.jsx`
3. КОГДА удаляются промежуточные итерации ТОГДА все компоненты в `packages/flowise-core-frontend/base/src/ui-components`, которые были доработаны для нового дизайна, ДОЛЖНЫ быть проанализированы на предмет удаления
4. КОГДА очищается код ТОГДА все дублирующие и тестовые компоненты ДОЛЖНЫ быть найдены и удалены после создания правильных версий