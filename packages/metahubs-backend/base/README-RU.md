# @universo/metahubs-backend

> üèóÔ∏è **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞–∫–µ—Ç** - TypeScript-first –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Express.js –∏ TypeORM

–ë—ç–∫–µ–Ω–¥-—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ—Ç–∞—Ö–∞–±–∞–º–∏, —Ö–∞–±–∞–º–∏, –∫–∞—Ç–∞–ª–æ–≥–∞–º–∏, –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏, –∑–∞–ø–∏—Å—è–º–∏ –∏ —á–ª–µ–Ω—Å—Ç–≤–æ–º —Å–æ —Å—Ç—Ä–æ–≥–æ–π –∏–∑–æ–ª—è—Ü–∏–µ–π –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–µ—Ç–∞—Ö–∞–±–∞.

## –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–∫–µ—Ç–µ

- **–í–µ—Ä—Å–∏—è**: 0.1.0
- **–¢–∏–ø**: Backend Service Package (TypeScript)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: Express.js + TypeORM + Zod

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
- **–ú–µ—Ç–∞—Ö–∞–±—ã**: –í–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã —Å –ø–æ–ª–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö
- **–•–∞–±—ã**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –º–µ—Ç–∞—Ö–∞–±–æ–≤ (N:M —Å–≤—è–∑—å —Å –∫–∞—Ç–∞–ª–æ–≥–∞–º–∏)
- **–ö–∞—Ç–∞–ª–æ–≥–∏**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ö–µ–º –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (N:M —Å–≤—è–∑—å —Å —Ö–∞–±–∞–º–∏)
- **–ê—Ç—Ä–∏–±—É—Ç—ã**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª–µ–π –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- **–ó–∞–ø–∏—Å–∏**: –ó–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ö–µ–º–∞–º –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- **–ß–ª–µ–Ω—Å—Ç–≤–æ**: –ß–ª–µ–Ω—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–µ—Ç–∞—Ö–∞–±–µ —Å —Ä–æ–ª—è–º–∏ –∏ –ø—Ä–∞–≤–∞–º–∏

### –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –º–µ—Ç–∞—Ö–∞–±–æ–≤ ‚Äî –Ω–µ—Ç –º–µ–∂–º–µ—Ç–∞—Ö–∞–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- –°–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –º–µ–∂–¥—É —Ö–∞–±–∞–º–∏ –∏ –∫–∞—Ç–∞–ª–æ–≥–∞–º–∏ (–∫–∞—Ç–∞–ª–æ–≥ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ö–∞–±–∞–º)
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤—è–∑—è–º–∏
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ–± –æ—à–∏–±–∫–∞—Ö
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å guard-–∞–º–∏ –º–µ—Ç–∞—Ö–∞–±–∞/—Ö–∞–±–∞/–∫–∞—Ç–∞–ª–æ–≥–∞
- –ó–∞—â–∏—Ç–∞ –æ—Ç DoS-–∞—Ç–∞–∫ —á–µ—Ä–µ–∑ rate limiting

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –ü–∞—Ç—Ç–µ—Ä–Ω TypeORM Repository –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–∞–Ω–Ω—ã–º–∏
- PostgreSQL —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π JSONB –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä
- CASCADE —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π —Å UNIQUE –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –∫–æ—Ä–Ω—è workspace
pnpm install

# –°–±–æ—Ä–∫–∞ –ø–∞–∫–µ—Ç–∞
pnpm --filter @universo/metahubs-backend build
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Express Router (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```typescript
import express from 'express'
import { createMetahubsServiceRoutes, initializeRateLimiters } from '@universo/metahubs-backend'

const app = express()
app.use(express.json())

await initializeRateLimiters()

app.use('/api/v1', createMetahubsServiceRoutes(ensureAuth, getDataSource))

app.listen(3000)
```

–ì–¥–µ:
- `ensureAuth` ‚Äî –≤–∞—à–µ middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `getDataSource` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TypeORM `DataSource`

## –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ API

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –º–µ—Ç–∞—Ö–∞–±–æ–≤
```http
GET    /metahubs                               # –°–ø–∏—Å–æ–∫ –º–µ—Ç–∞—Ö–∞–±–æ–≤
POST   /metahubs                               # –°–æ–∑–¥–∞—Ç—å –º–µ—Ç–∞—Ö–∞–±
GET    /metahub/:metahubId                     # –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –º–µ—Ç–∞—Ö–∞–±–∞
PUT    /metahub/:metahubId                     # –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞—Ö–∞–±
DELETE /metahub/:metahubId                     # –£–¥–∞–ª–∏—Ç—å –º–µ—Ç–∞—Ö–∞–± (CASCADE)

GET    /metahub/:metahubId/members             # –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –º–µ—Ç–∞—Ö–∞–±–∞
POST   /metahub/:metahubId/members             # –î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
PATCH  /metahub/:metahubId/member/:memberId    # –û–±–Ω–æ–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
DELETE /metahub/:metahubId/member/:memberId    # –£–¥–∞–ª–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ö–∞–±–æ–≤
```http
GET    /metahub/:metahubId/hubs                # –°–ø–∏—Å–æ–∫ —Ö–∞–±–æ–≤ –≤ –º–µ—Ç–∞—Ö–∞–±–µ
POST   /metahub/:metahubId/hubs                # –°–æ–∑–¥–∞—Ç—å —Ö–∞–±
GET    /metahub/:metahubId/hub/:hubId          # –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ —Ö–∞–±–∞
PATCH  /metahub/:metahubId/hub/:hubId          # –û–±–Ω–æ–≤–∏—Ç—å —Ö–∞–±
DELETE /metahub/:metahubId/hub/:hubId          # –£–¥–∞–ª–∏—Ç—å —Ö–∞–±
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∫–∞—Ç–∞–ª–æ–≥–æ–≤
```http
GET    /metahub/:metahubId/catalogs                               # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤ –º–µ—Ç–∞—Ö–∞–±–µ
POST   /metahub/:metahubId/catalogs                               # –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–µ—Ç–∞—Ö–∞–±–∞
GET    /metahub/:metahubId/catalog/:catalogId                     # –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ (—É—Ä–æ–≤–µ–Ω—å –º–µ—Ç–∞—Ö–∞–±–∞)
PATCH  /metahub/:metahubId/catalog/:catalogId                     # –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ (—É—Ä–æ–≤–µ–Ω—å –º–µ—Ç–∞—Ö–∞–±–∞)
DELETE /metahub/:metahubId/catalog/:catalogId                     # –£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ (—É—Ä–æ–≤–µ–Ω—å –º–µ—Ç–∞—Ö–∞–±–∞)

GET    /metahub/:metahubId/hub/:hubId/catalogs                     # –°–ø–∏—Å–æ–∫ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤ —Ö–∞–±–µ
POST   /metahub/:metahubId/hub/:hubId/catalogs                     # –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –≤ —Ö–∞–±–µ
GET    /metahub/:metahubId/hub/:hubId/catalog/:catalogId           # –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
PATCH  /metahub/:metahubId/hub/:hubId/catalog/:catalogId           # –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
DELETE /metahub/:metahubId/hub/:hubId/catalog/:catalogId           # –£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤
```http
GET    /metahub/:m/hub/:h/catalog/:c/attributes                   # –°–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
POST   /metahub/:m/hub/:h/catalog/:c/attributes                   # –°–æ–∑–¥–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
GET    /metahub/:m/hub/:h/catalog/:c/attribute/:attrId            # –ü–æ–ª—É—á–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
PATCH  /metahub/:m/hub/:h/catalog/:c/attribute/:attrId            # –û–±–Ω–æ–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
DELETE /metahub/:m/hub/:h/catalog/:c/attribute/:attrId            # –£–¥–∞–ª–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
PATCH  /metahub/:m/hub/:h/catalog/:c/attribute/:attrId/move       # –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)

GET    /metahub/:m/catalog/:c/attributes                          # –°–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
POST   /metahub/:m/catalog/:c/attributes                          # –°–æ–∑–¥–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
GET    /metahub/:m/catalog/:c/attribute/:attrId                   # –ü–æ–ª—É—á–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
PATCH  /metahub/:m/catalog/:c/attribute/:attrId                   # –û–±–Ω–æ–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
DELETE /metahub/:m/catalog/:c/attribute/:attrId                   # –£–¥–∞–ª–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
PATCH  /metahub/:m/catalog/:c/attribute/:attrId/move              # –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞–ø–∏—Å–µ–π
```http
GET    /metahub/:m/hub/:h/catalog/:c/records                      # –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
POST   /metahub/:m/hub/:h/catalog/:c/records                      # –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
GET    /metahub/:m/hub/:h/catalog/:c/record/:recordId             # –ü–æ–ª—É—á–∏—Ç—å –∑–∞–ø–∏—Å—å (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
PATCH  /metahub/:m/hub/:h/catalog/:c/record/:recordId             # –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)
DELETE /metahub/:m/hub/:h/catalog/:c/record/:recordId             # –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å (—É—Ä–æ–≤–µ–Ω—å —Ö–∞–±–∞)

GET    /metahub/:m/catalog/:c/records                             # –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
POST   /metahub/:m/catalog/:c/records                             # –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
GET    /metahub/:m/catalog/:c/record/:recordId                    # –ü–æ–ª—É—á–∏—Ç—å –∑–∞–ø–∏—Å—å (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
PATCH  /metahub/:m/catalog/:c/record/:recordId                    # –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
DELETE /metahub/:m/catalog/:c/record/:recordId                    # –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

#### –°–æ–∑–¥–∞—Ç—å –º–µ—Ç–∞—Ö–∞–±
```http
POST /metahubs
Content-Type: application/json

{
  "name": "Gaming Hub",
  "description": "Virtual gaming worlds and assets"
}
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "Gaming Hub", 
    "description": "Virtual gaming worlds and assets",
    "createdAt": "2024-01-15T10:30:00Z",
    "updatedAt": "2024-01-15T10:30:00Z"
  }
}
```

#### –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
```http
POST /metahub/:metahubId/hub/:hubId/catalog/:catalogId/records
Content-Type: application/json

{
  "data": {
    "name": "Player Avatar",
    "model": "character.fbx",
    "animations": ["idle", "walk", "run"]
  }
}
```

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)

- `Metahub`: –≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è/—Ä–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ).
- `Hub`: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –º–µ—Ç–∞—Ö–∞–±–∞.
- `Catalog`: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (N:M —Å —Ö–∞–±–∞–º–∏ —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É —Å–≤—è–∑–µ–π).
- `Attribute`: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—è –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ (–∏–º—è, —Ç–∏–ø, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è).
- `Record`: –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Å—Ö–µ–º–µ –∫–∞—Ç–∞–ª–æ–≥–∞ (JSONB –¥–∞–Ω–Ω—ã–µ).
- `MetahubUser`: —á–ª–µ–Ω—Å—Ç–≤–æ —Å —Ä–æ–ª—è–º–∏ –∏ –ø—Ä–∞–≤–∞–º–∏.

### –¢–∞–±–ª–∏—Ü—ã —Å–≤—è–∑–µ–π

- `CatalogHub`: —Å–≤—è–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∏ —Å —Ö–∞–±–∞–º–∏ (—Å–≤—è–∑—å N:M).

–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –¢–∞–±–ª–∏—Ü—ã —Å–≤—è–∑–µ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç `UNIQUE` –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –ø–∞—Ä—ã –∏ `ON DELETE CASCADE` –¥–ª—è —Å—Å—ã–ª–æ—á–Ω–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏.
- –ö–∞—Ç–∞–ª–æ–≥ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ö–∞–±–∞–º –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –º–µ—Ç–∞—Ö–∞–±–∞.

## –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞

- `metahubId` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
- `hubId` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞—Ç–∞–ª–æ–≥–æ–≤.
- `catalogId` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –∑–∞–ø–∏—Å–µ–π.
- UUID-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è, –∞ –¥–æ—Å—Ç—É–ø –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è guard-–∞–º–∏.

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π

–°—É—â–Ω–æ—Å—Ç–∏ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ Metahubs —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ Flowise core backend:

```typescript
// flowise-core-backend/base/src/database/entities/index.ts
import { metahubsEntities } from '@universo/metahubs-backend'

// flowise-core-backend/base/src/database/migrations/postgres/index.ts
import { metahubsMigrations } from '@universo/metahubs-backend'
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
```bash
pnpm --filter @universo/metahubs-backend build
pnpm --filter @universo/metahubs-backend dev
pnpm --filter @universo/metahubs-backend test
pnpm --filter @universo/metahubs-backend lint
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
src/
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îî‚îÄ‚îÄ migrations/
‚îú‚îÄ‚îÄ domains/
‚îÇ   ‚îú‚îÄ‚îÄ attributes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ catalogs/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ hubs/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ metahubs/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ publications/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ records/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ ddl/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ definitions/
‚îÇ   ‚îî‚îÄ‚îÄ shared/
‚îú‚îÄ‚îÄ tests/
‚îú‚îÄ‚îÄ types/
‚îú‚îÄ‚îÄ utils/
‚îî‚îÄ‚îÄ index.ts
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å `ensureMetahubAccess`, `ensureHubAccess` –∏ `ensureCatalogAccess`.
- Rate limiting –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `initializeRateLimiters()`.

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
- [`@universo/metahubs-frontend`](../metahubs-frontend/base/README.md) - Frontend client
- [`@universo/auth-backend`](../auth-backend/base/README.md) - Authentication service
- [`@universo/utils`](../universo-utils/base/README.md) - Shared utilities

---
*–ß–∞—Å—Ç—å [Universo Platformo](../../../README.md)*
