# @universo/flowise-apikey-backend

–ë—ç–∫–µ–Ω–¥-–ø–∞–∫–µ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è API-–∫–ª—é—á–∞–º–∏ –≤ Universo Platformo (–∏–∑–≤–ª–µ—á—ë–Ω –∏–∑ flowise-server).

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±—ç–∫–µ–Ω–¥-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è API-–∫–ª—é—á–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ chatflow –∏ agentflow. API-–∫–ª—é—á–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–º AI-–≤–æ—Ä–∫—Ñ–ª–æ—É.

## –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–∫–µ—Ç–µ

- **–ü–∞–∫–µ—Ç**: `@universo/flowise-apikey-backend`
- **–í–µ—Ä—Å–∏—è**: `0.1.0`
- **–¢–∏–ø**: –ë—ç–∫–µ–Ω–¥ (–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π)
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: Express.js, TypeORM, TypeScript
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: `@universo/uniks-backend` (—Å–≤—è–∑—å —Å —Å—É—â–Ω–æ—Å—Ç—å—é Unik)

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üóÑÔ∏è –°–ª–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **–°—É—â–Ω–æ—Å—Ç—å ApiKey**: TypeORM-—Å—É—â–Ω–æ—Å—Ç—å —Å–æ —Å–≤—è–∑—å—é —Å Unik –¥–ª—è –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏
- **–ú–∏–≥—Ä–∞—Ü–∏–∏**: –ú–∏–≥—Ä–∞—Ü–∏–∏ PostgreSQL –¥–ª—è —Å—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü—ã api_key

### üîß –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
- **ApiKeyService**: CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º DI
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π**: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è API-–∫–ª—é—á–µ–π
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: Zod-—Å—Ö–µ–º—ã –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ HTTP-—Å—Ç–∞—Ç—É—Å–∞–º–∏

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π**: API-–∫–ª—é—á–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- **–ò–∑–æ–ª—è—Ü–∏—è Unik**: API-–∫–ª—é—á–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –æ—Ç–¥–µ–ª—å–Ω—ã–º Unik

### üõ£Ô∏è –°–ª–æ–π –º–∞—Ä—à—Ä—É—Ç–æ–≤
- **Express Router**: RESTful API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å middleware –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏**: –ü—Ä–æ–≤–µ—Ä–∫–∞ API-–∫–ª—é—á–µ–π –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **–ü–∞—Ç—Ç–µ—Ä–Ω DI**: –§–∞–±—Ä–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pnpm add @universo/flowise-apikey-backend
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import {
    createApiKeyService,
    createApiKeyRouter,
    ApiKey,
    apiKeyMigrations
} from '@universo/flowise-apikey-backend'

// –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ —Å DI
const apiKeyService = createApiKeyService({
    getDataSource: () => dataSource,
    telemetry: telemetryService,
    metrics: metricsProvider
})

// –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞
const apiKeyRouter = createApiKeyRouter({ apiKeyService })

// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞
app.use('/api/v1/unik/:unikId/apikeys', apiKeyRouter)
```

## –≠–∫—Å–ø–æ—Ä—Ç—ã

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `ApiKey` - TypeORM-—Å—É—â–Ω–æ—Å—Ç—å
- `apiKeyMigrations` - –ú–∞—Å—Å–∏–≤ –º–∏–≥—Ä–∞—Ü–∏–π

### –°–µ—Ä–≤–∏—Å—ã
- `createApiKeyService` - –§–∞–±—Ä–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞
- `IApiKeyService` - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ä–≤–∏—Å–∞
- `ApiKeyServiceConfig` - –¢–∏–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `ApiKeyServiceError` - –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–ª–∞—Å—Å –æ—à–∏–±–∫–∏

### –ú–∞—Ä—à—Ä—É—Ç—ã
- `createApiKeyRouter` - –§–∞–±—Ä–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞
- `apiKeyErrorHandler` - Express middleware –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- `ApiKeyControllerError` - –ö–ª–∞—Å—Å –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

### –£—Ç–∏–ª–∏—Ç—ã
- `generateAPIKey` - –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö API-–∫–ª—é—á–µ–π
- `jsonStorage` - –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å JSON-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
packages/flowise-apikey-backend/
‚îú‚îÄ‚îÄ base/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/      # –°—É—â–Ω–æ—Å—Ç—å ApiKey
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/    # –ú–∏–≥—Ä–∞—Ü–∏–∏ PostgreSQL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/            # Express-—Ä–æ—É—Ç–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/             # –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ dist/                  # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (EN)
‚îÇ   ‚îî‚îÄ‚îÄ README-RU.md           # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ package.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞
```

## API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/unik/:unikId/apikeys` | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ API-–∫–ª—é—á–∏ –¥–ª—è Unik |
| GET | `/unik/:unikId/apikeys/:id` | –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π API-–∫–ª—é—á –ø–æ ID |
| POST | `/unik/:unikId/apikeys` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π API-–∫–ª—é—á |
| PUT | `/unik/:unikId/apikeys/:id` | –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π API-–∫–ª—é—á |
| DELETE | `/unik/:unikId/apikeys/:id` | –£–¥–∞–ª–∏—Ç—å API-–∫–ª—é—á |
| GET | `/unik/:unikId/apikey/:apikey` | –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å API-–∫–ª—é—á |

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pnpm install

# –°–±–æ—Ä–∫–∞
pnpm build

# –ó–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞
pnpm lint

# –†–µ–∂–∏–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
pnpm dev
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

Apache License Version 2.0 - –°–º. —Ñ–∞–π–ª [LICENSE](../../../LICENSE) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.
