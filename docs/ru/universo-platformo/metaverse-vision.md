# Видение метавселенных Universo Platformo

> Данный документ фиксирует ключевые идеи и архитектурные решения для домена «метавселенные» в рамках Universo Platformo React. Служит единой точкой входа для более детальных спецификаций.

## 1. Что такое Universo Platformo

-   Технологическая платформа для «текнокомизации» (автоматизации/цифровизации/роботизации) всего — от игровых миров до реальных предприятий
-   Многостековая экосистема: разные реализации (React, иные фреймворки) совместимы на уровне высокоабстрактной логики (UPDL)

## 2. Текущая приоритетная реализация: Universo Platformo React

-   Монорепозиторий на основе Flowise 2.2.x (не 3.x), без цели поддерживать совместимый форк
-   Архитектура: фронтенд React + бэкенд Express, интеграция с UPDL (React Flow, LangChain-контекст)
-   Наш функционал живёт в `packages/` как workspace-пакеты, постепенно вытесняя исходный `packages/`

## 3. Стратегия пакетов и маркетплейса

-   `packages/` — независимые приложения/пакеты с собственной лицензией (Омская Открытая Лицензия — Базовая модификация)
-   Цель: рефакторинг базового кода, разделение на самостоятельные репозитории
-   Базовое приложение Universo Platformo React предлагает установить приложения из каталога или готовые наборы (например, Universo Kiberplano, Universo MMOOMM)

## 4. Мультистековая публикация

-   Приложения могут включать компоненты для разных технологий (веб, нативные, backend libs)
-   Высокоабстрактный слой UPDL → публикация в целевые стеки (в т.ч. обратно в Universo Platformo React)

## 5. Сеть узлов Universo Platformo

-   Развёртывание локальных узлов (он-прем для предприятий)
-   Возможность частичной связи с глобальной сетью
-   Глобальная сеть: региональные узлы, p2p-подсети, гибридные топологии

## 6. Логическая структура: Метавселенные

-   Главная сущность: «Метавселенная»
-   У каждого пользователя есть базовая метавселенная; можно создавать дополнительные
-   Внутри: Uniks → Spaces → данные и логика (UPDL-узлы: Space, Entity, Component, Event, Action, Data, Universo)
-   Метавселенные могут связываться (дочерние/партнёрские)

## 7. Universo MMOOMM как набор метавселенных

-   Параллельные миры с разной экономикой/политикой/валютами — отдельные метавселенные
-   Метавселенной может быть и участок внутри большого мира
-   Возможность внести свою метавселенную в чужой проект (подключаемые локации)

## 8. Пользовательское творчество и импорт

-   Пользователи создают игры/виртуальные миры на UPDL
-   Импорт существующих проектов в высокоабстрактный слой (конвертация в UPDL)

## 9. Экономика и цифровые двойники

-   Создание предприятий (в т.ч. народных), организаций (профсоюзы), производственных цепочек
-   Ресурсные конфигурации и чертежи изделий
-   Масштабирование до цифровых двойников городов и перенос решений в реальный мир

## 10. Публикация и ранний технологический стек

-   Публикация в PlayCanvas (и сопутствующие технологии) через экспортный шаблон MMOOMM
-   Настройка в UPDL-узлах + публикация = развёрнутый клиентский опыт

## 11. Бэкенд сегодня и завтра

-   Текущая реализация: Express + Supabase (PostgreSQL, Auth, Realtime)
-   В перспективе: генерация бэкенд-логики узлами UPDL

## 12. Текущие параллельные направления

-   AR-квизы для образования, блочный редактор (аналог Notion) для сценариев, канвас-диаграммы (аналог Miro)

---

## Архитектурная модель «Метавселенная»

### Границы домена

-   Метавселенная — контейнер логики и данных: пространства, сущности (ECS), экономические правила, связи с другими метавселенными
-   Управляет правами доступа, владением, наследованием и партнёрскими связями

### Связь с UPDL

-   UPDL-узлы формируют высокоабстрактную логику внутри Spaces
-   Публикация (Template Engine) конвертирует UPDL → целевой стек (PlayCanvas и др.)

### Модель данных (высокоуровнево)

-   `metaverse` (id, owner_id, visibility, settings, parent_id?)
-   `unik` (id, metaverse_id, type, metadata)
-   `space` (id, unik_id, layout, updl_graph)
-   `link` (metaverse_id, target_metaverse_id, relation: child|partner)
-   Привязки к ECS: `entity` с `world_id = metaverse_id` или пространственным контекстом

### Интерфейсы (минимум)

-   Метавселенная: CRUD, связь дочерняя/партнёрская, управление доступом
-   Публикация: экспорт по шаблонам, предпросмотр
-   Интеграции: Supabase Auth, Realtime события, API Gateway

### События

-   `metaverse.created`, `metaverse.linked`, `metaverse.published`
-   `space.updated`, `updl.graph.changed`
-   `entity.created|moved|state.updated` (через ECS)

### Развёртывание

-   Локальные/региональные/глобальные узлы; p2p-мосты
-   Маркетплейс приложений и готовых проектов

---

## Карта приложений для метавселенных

-   `metaverse-backend` — бэкенд домена метавселенных (управление, связи, публикация хаков)
-   `metaverse-frontend` — фронтенд управления метавселенными (консоль, визард, маркетплейс интеграция)
-   Связанные сервисы: `resources-backend`, `entities-backend`, `economy-backend`, `publish-frontend`, `template-engine-backend`

## Связанные разделы

-   Приложения → Метавселенные (`applications/metaverse/`)
-   Целевая архитектура (`roadmap/target-architecture/README.md`)
-   План реализации (`roadmap/implementation-plan/README.md`)

## Миграция Chatflow → Space

-   Исторически «Chatflow» (Flowise) становится «Space» в Universo Platformo
-   Внутри Space логика строится семью базовыми UPDL-узлами: `Space`, `Entity`, `Component`, `Event`, `Action`, `Data`, `Universo`
-   Один стартовый Space может представлять MVP-проект; далее допускаются множественные Spaces на Unik

## Метавселенная по умолчанию

-   У каждого пользователя создаётся «дефолтная метавселенная» при первом запуске (или через визард)
-   Можно создавать дополнительные метавселенные и связывать их: дочерние или партнёрские

## Дополнение про мультистек

-   Устанавливаемые приложения могут включать не только фронтенд, но и бэкенд-компоненты в виде скомпилированных библиотек/сервисов
-   Высокоабстрактная логика узлов Universo Platformo публикуется в совместимые стеки, включая обратно в Universo Platformo React

## Подключаемые локации

-   Собственная метавселенная может подключаться как «локация» в чужой проект (например, в Universo MMOOMM)
-   Договорённости и права оформляются через партнёрские связи и ACL
