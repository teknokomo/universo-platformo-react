---
description: Узнайте, как управлять API-запросами в Universo Platformo
---

# Ограничение скорости

***

Когда вы делаете свой холст публичным без авторизации API через API или встроенный чат, любой может получить доступ к потоку. Чтобы предотвратить спам, вы можете установить ограничение скорости на своём холсте.

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" width="462"><figcaption></figcaption></figure>

* **Message Limit per Duration**: Сколько сообщений может быть получено за определённый период. Например: 20
* **Duration in Seconds**: Указанный период. Например: 60
* **Limit Message**: Какое сообщение вернуть при превышении лимита. Например: Quota Exceeded

Используя приведённый выше пример, это означает, что только 20 сообщений могут быть получены за 60 секунд. Ограничение скорости отслеживается по IP-адресу. Если вы развернули Universo Platformo в облачном сервисе, вам нужно установить переменную окружения `NUMBER_OF_PROXIES`.

## Настройка ограничения скорости

Когда вы размещаете Universo Platformo в облаке, таком как AWS, GCP, Azure и т.д., скорее всего, вы находитесь за прокси/балансировщиком нагрузки. Поэтому ограничение скорости может не работать. Больше информации можно найти [здесь](https://github.com/express-rate-limit/express-rate-limit/wiki/Troubleshooting-Proxy-Issues).

Чтобы исправить проблему:

1. **Установите переменную окружения:** Создайте переменную окружения с именем `NUMBER_OF_PROXIES` и установите её значение в `0` в вашей среде хостинга.
2. **Перезапустите размещённый экземпляр Universo Platformo:** Это позволит Universo Platformo применить изменения переменных окружения.
3. **Проверьте IP-адрес:** Чтобы проверить IP-адрес, перейдите по URL: `{{hosted_url}}/api/v1/ip`. Вы можете сделать это, введя URL в веб-браузер или выполнив API-запрос.
4. **Сравните IP-адрес** После выполнения запроса сравните возвращённый IP-адрес с вашим текущим IP-адресом. Вы можете узнать свой текущий IP-адрес, посетив любой из этих сайтов:
   * [http://ip.nfriedly.com/](http://ip.nfriedly.com/)
   * [https://api.ipify.org/](https://api.ipify.org/)
5. **Неправильный IP-адрес:** Если возвращённый IP-адрес не совпадает с вашим текущим IP-адресом, увеличьте `NUMBER_OF_PROXIES` на 1 и перезапустите экземпляр Universo Platformo. Повторяйте этот процесс, пока IP-адрес не совпадёт с вашим.
